/*
 Angular Resource Tastypie v1.0.0
 (c) 2014-2015 Marcos William Ferretti, https://github.com/mw-ferretti/angular-resource-tastypie
 License: MIT
*/
var ngResourceTastypie={name:"Angular Resource Tastypie",description:"RESTful AngularJs client for Django-Tastypie or equivalent schema.",version:{full:"1.0.0",major:1,minor:0,dot:0,codeName:"Alpha"},author:{name:"Marcos William Ferretti",email:"ferretti.spo@gmail.com",github:"https://github.com/mw-ferretti/",linkedin:"https://www.linkedin.com/in/mwferretti"},license:"MIT, (c) 2014-2015 Marcos William Ferretti",source:"https://github.com/mw-ferretti/angular-resource-tastypie"};
if("undefined"==typeof angular)throw"[ngResourceTastypie v".concat(ngResourceTastypie.version.full,"] Requires AngularJs 1.3+");if(1>angular.version.major||1==angular.version.major&&3>angular.version.minor)throw"[ngResourceTastypie v".concat(ngResourceTastypie.version.full,"] Requires AngularJs 1.3+, your version is ",angular.version.full);function TastypieConfig(h){h.defaults.stripTrailingSlashes=!1}
function TastypieProvider(h){h.defaults.useXDomain=!0;delete h.defaults.headers.common["X-Requested-With"];h.defaults.headers.common["Content-Type"]="application/json";var l="",m="",f={username:"",api_key:""};this.setResourceUrl=function(e){l=e;e=document.createElement("a");e.href=l;m=e.protocol.concat("//",e.hostname);""!=e.port&&(m=m.concat(":",e.port))};this.setAuth=function(e,g){f.username=e;f.api_key=g;h.defaults.headers.common.Authorization="ApiKey ".concat(f.username,":",f.api_key)};this.getAuth=
function(){return f};this.getResourceUrl=function(){return l};this.getResourceDomain=function(){return m};var g=[];Object.defineProperties(this,{working:{get:function(){return 0<g.length},set:function(e){"undefined"==typeof e&&(e=!1);e?g.push(1):g.splice(-1,1)}}});this.$get=function(){return{resource_url:this.getResourceUrl(),resource_domain:this.getResourceDomain(),auth:this.getAuth(),working:this.working,setAuth:this.setAuth,setResourceUrl:this.setResourceUrl}}}
function TastypiePaginatorFactory(h,l,m){function f(a,c,b){this.resource=a;this.filters=c||{};this.meta={};this.objects=[];this.length=this.index=0;this.range=[];e(this,b)}function g(a){var c=m.defer();"object"==typeof console&&console.log(a);c.reject({statusText:a});return c.promise}function e(a,c){if(!angular.isObject(c.meta))throw"[$tastypiePaginator] Invalid django-tastypie object.";a.meta=c.meta;for(var b=0;b<c.objects.length;b++)c.objects[b]=a.resource.objects.$create(c.objects[b]);a.objects=
c.objects;a.length=Math.ceil(c.meta.total_count/c.meta.limit);a.index=0==c.meta.offset?1:Math.ceil(c.meta.offset/c.meta.limit)+1;for(var b=[],k=1;k<=a.length;k++)b.push(k);a.range=b}function n(a,c){if(c)return a.resource.working=!0,h(c).get().$promise.then(function(k){e(a,k);a.resource.working=!1;return a},function(k){k=k||{};k.statusText="[$tastypiePaginator][$get] ".concat(k.statusText||"Server Not Responding.");a.resource.working=!1;throw k;});var b="[$tastypiePaginator][$get] ".concat("Invalid url.");
return g(b)}function a(d,c,b){if(c==d.index&&!b)return b="[$tastypiePaginator][$get] ".concat("Index ",c," has already been loaded."),g(b);if(0<c&&c<=d.length)return d.resource.working=!0,b=angular.copy(d.filters),b.offset=(c-1)*d.meta.limit,h(d.resource.endpoint,d.resource.defaults).get(b).$promise.then(function(k){if(k.meta.offset==k.meta.total_count)a(d,c-1,!0);else return e(d,k),d.resource.working=!1,d},function(a){a=a||{};a.statusText="[$tastypiePaginator][$get] ".concat(a.statusText||"Server Not Responding.");
d.resource.working=!1;throw a;});b="[$tastypiePaginator][$get] ".concat("Index ",c," not exist.");return g(b)}f.prototype.change=function(d){if(d)return a(this,d,!1);d="[$tastypiePaginator][change] ".concat('Parameter "index" not informed.');return g(d)};f.prototype.next=function(){if(this.meta.next)return n(this,l.resource_domain.concat(this.meta.next));var a="[$tastypiePaginator][next] ".concat("Not exist next pages.");return g(a)};f.prototype.previous=function(){if(this.meta.previous)return n(this,
l.resource_domain.concat(this.meta.previous));var a="[$tastypiePaginator][previous] ".concat("Not exist previous pages.");return g(a)};f.prototype.refresh=function(){return a(this,this.index,!0)};f.prototype.first=function(){return a(this,1,!1)};f.prototype.last=function(){return a(this,this.length,!1)};return f}
function TastypieObjectsFactory(h,l,m){function f(a){this.resource=a}function g(a){var d=m.defer();"object"==typeof console&&console.log(a);d.reject({statusText:a});return d.promise}function e(a,d){var c={post:{method:"POST"},save:{method:"POST"},get:{method:"GET",url:a.resource.endpoint.concat(":id/")},get_uri:{method:"GET",url:a.resource.endpoint.concat(":id/")},update:{method:"PATCH",url:a.resource.endpoint.concat(":id/")},put:{method:"PUT",url:a.resource.endpoint.concat(":id/")},patch:{method:"PATCH",
url:a.resource.endpoint.concat(":id/")},"delete":{method:"DELETE",url:a.resource.endpoint.concat(":id/")},remove:{method:"DELETE",url:a.resource.endpoint.concat(":id/")}},c=h(a.resource.endpoint,{id:"@id"},c);delete c.prototype.$query;c.prototype.$get=function(b){angular.extend(this,b||{});if(!this.hasOwnProperty("id"))return b="[$tastypieObjects][$get] ".concat("Attribute [id] is required."),g(b);a.resource.working=!0;return this.$get_uri().then(function(b){a.resource.working=!1;return b},function(b){b=
b||{};b.statusText="[$tastypieObjects][$get] ".concat(b.statusText||"Server Not Responding.");a.resource.working=!1;throw b;})};c.prototype.$save=function(b){angular.extend(this,b||{});b=this.hasOwnProperty("id")?this.$put():this.$post();a.resource.working=!0;return b.then(function(b){a.resource.working=!1;typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();return b},function(b){b=b||{};b.statusText="[$tastypieObjects][$save] ".concat(b.statusText||"Server Not Responding.");
a.resource.working=!1;throw b;})};c.prototype.$update=function(b){angular.extend(this,b||{});if(!this.hasOwnProperty("id"))return b="[$tastypieObjects][$update] ".concat("Attribute [id] is required."),g(b);a.resource.working=!0;return this.$patch().then(function(b){a.resource.working=!1;typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();return b},function(b){b=b||{};b.statusText="[$tastypieObjects][$update] ".concat(b.statusText||"Server Not Responding.");a.resource.working=
!1;throw b;})};c.prototype.$delete=function(b){var c=this;angular.extend(c,b||{});if(!c.hasOwnProperty("id"))return b="[$tastypieObjects][$delete] ".concat("Attribute [id] is required."),g(b);a.resource.working=!0;return c.$remove().then(function(b){a.resource.working=!1;angular.forEach(c,function(a,b){delete c[b]});typeof a.resource.page.refresh==typeof Function&&a.resource.page.refresh();return b},function(b){b=b||{};b.statusText="[$tastypieObjects][$delete] ".concat(b.statusText||"Server Not Responding.");
a.resource.working=!1;throw b;})};c.prototype.$clear=function(){var a=this;angular.forEach(a,function(c,d){delete a[d]})};return new c(d)}function n(a){var d=h(a.resource.endpoint,a.resource.defaults,{get:{method:"GET"},find:{method:"GET"}});d.prototype.$find=function(c){a.resource.working=!0;return this.$get(c).then(function(b){a.resource.working=!1;a.resource.page=new l(a.resource,c,b);return a.resource.page},function(b){b=b||{};b.statusText="[$tastypieObjects][$find] ".concat(b.statusText||"Server Not Responding.");
a.resource.working=!1;throw b;})};return new d}f.prototype.$create=function(a){return e(this,a)};f.prototype.$get=function(a){return e(this,a).$get()};f.prototype.$delete=function(a){return e(this,a).$delete()};f.prototype.$find=function(a){return n(this).$find(a)};f.prototype.$update=function(a){return e(this,a).$update()};return f}
function TastypieResourceFactory(h,l,m,f){return function(g,e){if(!g)throw"[$tastypieResource] Unknown service name.";this.endpoint=l.resource_url.concat(g,"/");this.defaults=e||{};this.page={};this.objects=new f(this);var h=[];Object.defineProperties(this,{working:{get:function(){return 0<h.length},set:function(a){"undefined"==typeof a&&(a=!1);a?h.push(1):h.splice(-1,1);l.working=a}}})}}var ResourceTastypieModule=angular.module("ngResourceTastypie",["ngResource"]);
ResourceTastypieModule.constant("ngResourceTastypie",ngResourceTastypie);TastypieConfig.$inject=["$resourceProvider"];ResourceTastypieModule.config(TastypieConfig);TastypieProvider.$inject=["$httpProvider"];ResourceTastypieModule.provider("$tastypie",TastypieProvider);TastypiePaginatorFactory.$inject=["$resource","$tastypie","$q"];ResourceTastypieModule.factory("$tastypiePaginator",TastypiePaginatorFactory);TastypieObjectsFactory.$inject=["$resource","$tastypiePaginator","$q"];
ResourceTastypieModule.factory("$tastypieObjects",TastypieObjectsFactory);TastypieResourceFactory.$inject=["$resource","$tastypie","$tastypiePaginator","$tastypieObjects"];ResourceTastypieModule.factory("$tastypieResource",TastypieResourceFactory);
